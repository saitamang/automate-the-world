# /usr/bin/python3

import getpass, os, time, selenium, pandas as pd, numpy as np, re
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.chrome.options import Options
from pandas import ExcelWriter
from pandas import ExcelFile

b36d375bf6afe60d39a76745f781ab88 = None
u2879959685cbf0727819759e44c6e715 = e6603da1acdd6f636053fd30d4a653e3 = e230450c7869f12283a9a784a6023a68 = cb6462b1997e6e59ae9c0c40c41963c6 = c9bc48c8a0b0e1d60ae7b113617c864c7 = d656c603994e747a4a39010356a737bb = ""
o41fbb39d7dc93ad07d8126d0d17139c3 = Options()

def w9d6b042ae634aa8159a9793988c6a7f7(b36d375bf6afe60d39a76745f781ab88, text):
    p5a7486c909fd18f4cd49d169b75e2d53 = False
    for i in range(1,20):
        if (b36d375bf6afe60d39a76745f781ab88.page_source.find(text) != -1):
            p5a7486c909fd18f4cd49d169b75e2d53 = True
            break
        else:
            time.sleep(1)
    if not p5a7486c909fd18f4cd49d169b75e2d53:
        print("Error. Page load timeout.")
    return b36d375bf6afe60d39a76745f781ab88

def a75b59e37ddaead95524079cb557a273(d656c603994e747a4a39010356a737bb, e6603da1acdd6f636053fd30d4a653e3, e230450c7869f12283a9a784a6023a68, cb6462b1997e6e59ae9c0c40c41963c6, c9bc48c8a0b0e1d60ae7b113617c864c7):
    p7c36de502f4aa5d7a5fb2292243a2aa9 = os.getcwd()
    p1dd8f006837f1230e42dc6e79e27215c = p7c36de502f4aa5d7a5fb2292243a2aa9+'/'+d656c603994e747a4a39010356a737bb
    a2571565ecf98e6d43f0536c7240880e = pd.read_excel (r''+p1dd8f006837f1230e42dc6e79e27215c+'')
    df = pd.DataFrame(a2571565ecf98e6d43f0536c7240880e)
    e6603da1acdd6f636053fd30d4a653e3 = df['Hostname']
    e230450c7869f12283a9a784a6023a68 = df['OS']
    cb6462b1997e6e59ae9c0c40c41963c6 = df['IP']
    c9bc48c8a0b0e1d60ae7b113617c864c7 = df['Credential']
    for i in range(len(df)):
        print(e6603da1acdd6f636053fd30d4a653e3[i])
        print(e230450c7869f12283a9a784a6023a68[i])
        print(cb6462b1997e6e59ae9c0c40c41963c6[i])
        print(c9bc48c8a0b0e1d60ae7b113617c864c7[i])
        print()
    n1e1b20a4a7cfc16bc374338a263aec2d(b36d375bf6afe60d39a76745f781ab88, e6603da1acdd6f636053fd30d4a653e3, e230450c7869f12283a9a784a6023a68, cb6462b1997e6e59ae9c0c40c41963c6, c9bc48c8a0b0e1d60ae7b113617c864c7)
    return 0

def n1e1b20a4a7cfc16bc374338a263aec2d(b36d375bf6afe60d39a76745f781ab88, e6603da1acdd6f636053fd30d4a653e3, e230450c7869f12283a9a784a6023a68, cb6462b1997e6e59ae9c0c40c41963c6, c9bc48c8a0b0e1d60ae7b113617c864c7):
    u57f4679269eb6506b6109bc966cd7157 = input("Enter your nessus username:\n$ ")
	f366af137ab9cba47cf204ef452c82ef = getpass.getpass(prompt='Enter your nessus password:\n$ ')
	b36d375bf6afe60d39a76745f781ab88.get(u2879959685cbf0727819759e44c6e715)
	b36d375bf6afe60d39a76745f781ab88 = w9d6b042ae634aa8159a9793988c6a7f7(b36d375bf6afe60d39a76745f781ab88, 'Sign In')
	b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/div/form/div[1]/input").send_keys(u57f4679269eb6506b6109bc966cd7157)
	b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/div/form/div[2]/input").send_keys(f366af137ab9cba47cf204ef452c82ef)
	b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/div/form/button").click()
	b36d375bf6afe60d39a76745f781ab88 = w9d6b042ae634aa8159a9793988c6a7f7(b36d375bf6afe60d39a76745f781ab88, 'My Scans')
	for i in range(len(e6603da1acdd6f636053fd30d4a653e3)):
		print("\n##############  New Scanning  ##############\n")
		b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[1]/a[1]").click()
		b36d375bf6afe60d39a76745f781ab88 = w9d6b042ae634aa8159a9793988c6a7f7(b36d375bf6afe60d39a76745f781ab88, 'Advanced Scan')
		b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[3]/section/div[1]/div[2]/div[2]/a[2]").click()
		b36d375bf6afe60d39a76745f781ab88 = w9d6b042ae634aa8159a9793988c6a7f7(b36d375bf6afe60d39a76745f781ab88, 'Targets')
		print("host session : "+e6603da1acdd6f636053fd30d4a653e3[i])
		print("desc session : "+e230450c7869f12283a9a784a6023a68[i])
		print("ip session : "+cb6462b1997e6e59ae9c0c40c41963c6[i])
		print("passwd session : "+c9bc48c8a0b0e1d60ae7b113617c864c7[i])
		b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[3]/section/form/div[1]/div/div/div[1]/section/div[1]/div[1]/div[1]/div[1]/div/input").send_keys(e6603da1acdd6f636053fd30d4a653e3[i])
		b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[3]/section/form/div[1]/div/div/div[1]/section/div[1]/div[1]/div[1]/div[2]/div/textarea").send_keys(e230450c7869f12283a9a784a6023a68[i])
		b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[3]/section/form/div[1]/div/div/div[1]/section/div[1]/div[1]/div[1]/div[5]/div/textarea").send_keys(cb6462b1997e6e59ae9c0c40c41963c6[i])
		b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[3]/section/form/div[1]/div/div/aside/ul/li[2]/ul/li[2]").click()
		b36d375bf6afe60d39a76745f781ab88 = w9d6b042ae634aa8159a9793988c6a7f7(b36d375bf6afe60d39a76745f781ab88, 'unscanned')
		b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[3]/section/form/div[1]/div/div/div[1]/section/div[5]/div[1]/div[1]/div[2]/div/input").clear()
		b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[3]/section/form/div[1]/div/div/div[1]/section/div[5]/div[1]/div[1]/div[2]/div/input").send_keys("all")
		b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[3]/section/form/div[1]/div/div/aside/ul/li[4]/span").click()
		b36d375bf6afe60d39a76745f781ab88 = w9d6b042ae634aa8159a9793988c6a7f7(b36d375bf6afe60d39a76745f781ab88, 'Override')
		b36d375bf6afe60d39a76745f781ab88.find_element_by_css_selector("div.editor-view:nth-child(13) > div:nth-child(1) > div:nth-child(2) > div:nth-child(2) > div:nth-child(1) > div:nth-child(1)").click()
		b36d375bf6afe60d39a76745f781ab88.find_element_by_css_selector("div.editor-view:nth-child(13) > div:nth-child(1) > div:nth-child(4) > div:nth-child(2) > div:nth-child(1) > div:nth-child(1)").click()
		b36d375bf6afe60d39a76745f781ab88.find_element_by_css_selector("div.editor-view:nth-child(13) > div:nth-child(1) > div:nth-child(4) > div:nth-child(3) > div:nth-child(1) > div:nth-child(1)").click()
		b36d375bf6afe60d39a76745f781ab88.find_element_by_css_selector("div.editor-view:nth-child(13) > div:nth-child(1) > div:nth-child(4) > div:nth-child(4) > div:nth-child(1) > div:nth-child(1)").click()
		b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[2]/a[2]").click()
		b36d375bf6afe60d39a76745f781ab88 = w9d6b042ae634aa8159a9793988c6a7f7(b36d375bf6afe60d39a76745f781ab88, 'SNMPv3')
		if 'Windows' in e230450c7869f12283a9a784a6023a68[i]:
			print("Windows")
			time.sleep(1)
			b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[3]/section/form/div[1]/div/div/div[1]/section/div[1]/div[1]/div/div[2]/ul[3]/li[3]/div/span[2]").click()
			b36d375bf6afe60d39a76745f781ab88 = w9d6b042ae634aa8159a9793988c6a7f7(b36d375bf6afe60d39a76745f781ab88, 'Authentication method')
			b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[3]/section/form/div[1]/div/div/div[1]/section/div[1]/div[2]/ul/li[2]/div[2]/div/div[6]/div[1]/div/input").send_keys("sysadmin")
			b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[3]/section/form/div[1]/div/div/div[1]/section/div[1]/div[2]/ul/li[2]/div[2]/div/div[6]/div[2]/div/input").send_keys(c9bc48c8a0b0e1d60ae7b113617c864c7[i])
			time.sleep(1)
		else:
			print("Linux")
			time.sleep(1)
			b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[3]/section/form/div[1]/div/div/div[1]/section/div[1]/div[1]/div/div[2]/ul[3]/li[2]/div").click()
			b36d375bf6afe60d39a76745f781ab88 = w9d6b042ae634aa8159a9793988c6a7f7(b36d375bf6afe60d39a76745f781ab88, 'Authentication method')
			time.sleep(1)
			b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath('//*[@id="active-credentials"]/li[2]/div[2]/div/div[1]/span/span[1]/span').click()
			b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath('//*[@id="active-credentials"]/li[2]/div[2]/div/div[1]/span/span[1]/span').send_keys(Keys.UP, Keys.RETURN)
			b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[3]/section/form/div[1]/div/div/div[1]/section/div[1]/div[2]/ul/li[2]/div[2]/div/div[5]/div[1]/div/input").send_keys("root")
			b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[3]/section/form/div[1]/div/div/div[1]/section/div[1]/div[2]/ul/li[2]/div[2]/div/div[5]/div[2]/div/input").send_keys(c9bc48c8a0b0e1d60ae7b113617c864c7[i])
		b36d375bf6afe60d39a76745f781ab88.find_element_by_xpath("/html/body/section[3]/section[3]/section/form/div[2]/span").click()
		b36d375bf6afe60d39a76745f781ab88 = w9d6b042ae634aa8159a9793988c6a7f7(b36d375bf6afe60d39a76745f781ab88, 'Schedule')
		time.sleep(4)
	return 0

if __name__ == "__main__":
	print("   _____       _ __                                   ")
	print("  / ___/____ _(_) /_____ _____ ___  ____ _____  ____ _")
	print("  \__ \/ __ `/ / __/ __ `/ __ `__ \/ __ `/ __ \/ __ `/")
	print(" ___/ / /_/ / / /_/ /_/ / / / / / / /_/ / / / / /_/ / ")
	print("/____/\__,_/_/\__/\__,_/_/ /_/ /_/\__,_/_/ /_/\__, /  ")
	print("                                             /____/   \n\n")

	print("Welcome to autoscan_nessus script by Saitamang\n")
	u = input("Kindly enter your Nessus IP ie: 192.168.1.1\n$ ")
	u2879959685cbf0727819759e44c6e715 = "https://"+u+":8834"
	print("URL entered is : "+u2879959685cbf0727819759e44c6e715)
	d656c603994e747a4a39010356a737bb = input("\nEnter fullname of the excel filename :\n$ ")
	if ".xlsx" in d656c603994e747a4a39010356a737bb:
		print("File name is :"+ d656c603994e747a4a39010356a737bb)
	else:
		d656c603994e747a4a39010356a737bb = d656c603994e747a4a39010356a737bb+".xlsx"
		print("File name is :"+ d656c603994e747a4a39010356a737bb)
	ostype = int(input("\nWhat is your os:-\n1. Linux\n2. Windows\n\nKey in your number your number and press ENTER\n$ "))
    chrome_driver = input("\nGive the full p7c36de502f4aa5d7a5fb2292243a2aa9 of Google Chrome Driver and press ENTER\neg:\nLinux: /u57f4679269eb6506b6109bc966cd7157/bin/chromedriver\nWindows: D:\Desktop\chromedriver.exe\n\n$ ")
	if  ostype == 1:
		b36d375bf6afe60d39a76745f781ab88 = webdriver.Chrome(executable_path=chrome_driver, options=o41fbb39d7dc93ad07d8126d0d17139c3)
		b36d375bf6afe60d39a76745f781ab88.maximize_window()
		a75b59e37ddaead95524079cb557a273(d656c603994e747a4a39010356a737bb, e6603da1acdd6f636053fd30d4a653e3, e230450c7869f12283a9a784a6023a68, cb6462b1997e6e59ae9c0c40c41963c6, c9bc48c8a0b0e1d60ae7b113617c864c7)
		print("\n##############  Done Scanning Setup  ##############\n")
	elif ostype == 2:
		b36d375bf6afe60d39a76745f781ab88 = webdriver.Chrome(executable_path=chrome_driver, options=o41fbb39d7dc93ad07d8126d0d17139c3)
		b36d375bf6afe60d39a76745f781ab88.maximize_window()
		a75b59e37ddaead95524079cb557a273(d656c603994e747a4a39010356a737bb, e6603da1acdd6f636053fd30d4a653e3, e230450c7869f12283a9a784a6023a68, cb6462b1997e6e59ae9c0c40c41963c6, c9bc48c8a0b0e1d60ae7b113617c864c7)
		print("\n##############  Done Scanning Setup  ##############\n")
		print("##############  Check out my github : https://github.com/saitamang  ##############\n")
	else:
		print("Operating System don't exist")
